<?xml version="1.0" encoding="UTF-8"?><!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd"><html xmlns="http://www.w3.org/1999/xhtml" lang="en"><head><meta http-equiv="Content-Type" content="text/html;charset=UTF-8"/><link rel="stylesheet" href="../jacoco-resources/report.css" type="text/css"/><link rel="shortcut icon" href="../jacoco-resources/report.gif" type="image/gif"/><title>GameOptions.java</title><link rel="stylesheet" href="../jacoco-resources/prettify.css" type="text/css"/><script type="text/javascript" src="../jacoco-resources/prettify.js"></script></head><body onload="window['PR_TAB_WIDTH']=4;prettyPrint()"><div class="breadcrumb" id="breadcrumb"><span class="info"><a href="../jacoco-sessions.html" class="el_session">Sessions</a></span><a href="../index.html" class="el_report">megamek</a> &gt; <a href="index.source.html" class="el_package">megamek.common.options</a> &gt; <span class="el_source">GameOptions.java</span></div><h1>GameOptions.java</h1><pre class="source lang-java linenums">/*
 * MegaMek - Copyright (C) 2000,2001,2002,2003,2004 Ben Mazur (bmazur@sev.org)
 *
 *  This program is free software; you can redistribute it and/or modify it
 *  under the terms of the GNU General Public License as published by the Free
 *  Software Foundation; either version 2 of the License, or (at your option)
 *  any later version.
 *
 *  This program is distributed in the hope that it will be useful, but
 *  WITHOUT ANY WARRANTY; without even the implied warranty of MERCHANTABILITY
 *  or FITNESS FOR A PARTICULAR PURPOSE. See the GNU General Public License
 *  for more details.
 */
package megamek.common.options;

import java.io.File;
import java.io.FileInputStream;
import java.io.InputStream;
import java.util.Vector;

import javax.xml.bind.JAXBContext;
import javax.xml.bind.JAXBElement;
import javax.xml.bind.JAXBException;
import javax.xml.bind.Marshaller;
import javax.xml.bind.PropertyException;
import javax.xml.bind.Unmarshaller;
import javax.xml.bind.annotation.XmlAccessType;
import javax.xml.bind.annotation.XmlAccessorType;
import javax.xml.bind.annotation.XmlElement;
import javax.xml.bind.annotation.XmlRootElement;
import javax.xml.namespace.QName;

import megamek.MegaMek;
import megamek.common.TechConstants;
import megamek.utils.MegaMekXmlUtil;

/**
 * Contains the options determining play in the current game.
 *
 * @author Ben
 */
public class GameOptions extends AbstractOptions {
    private static final long serialVersionUID = 4916321960852747706L;
    private static final String GAME_OPTIONS_FILE_NAME = &quot;mmconf/gameoptions.xml&quot;; //$NON-NLS-1$

    public GameOptions() {
<span class="fc" id="L47">        super();</span>
<span class="fc" id="L48">    }</span>

    @Override
    public synchronized void initialize() {
<span class="fc" id="L52">        IBasicOptionGroup base = addGroup(&quot;basic&quot;); //$NON-NLS-1$</span>
<span class="fc" id="L53">        addOption(base, OptionsConstants.BASE_FRIENDLY_FIRE, false); //$NON-NLS-1$</span>
<span class="fc" id="L54">        addOption(base, OptionsConstants.BASE_SKIP_INELIGABLE_MOVEMENT, false); //$NON-NLS-1$</span>
<span class="fc" id="L55">        addOption(base, OptionsConstants.BASE_SKIP_INELIGABLE_FIRING, false); //$NON-NLS-1$</span>
<span class="fc" id="L56">        addOption(base, OptionsConstants.BASE_SKIP_INELIGABLE_PHYSICAL, true); //$NON-NLS-1$</span>
<span class="fc" id="L57">        addOption(base, OptionsConstants.BASE_PUSH_OFF_BOARD, true); //$NON-NLS-1$</span>
<span class="fc" id="L58">        addOption(base, OptionsConstants.BASE_TEAM_INITIATIVE, true); //$NON-NLS-1$</span>
<span class="fc" id="L59">        addOption(base, OptionsConstants.BASE_AUTOSAVE_MSG, true); //$NON-NLS-1$</span>
<span class="fc" id="L60">        addOption(base, OptionsConstants.BASE_PARANOID_AUTOSAVE, false); //$NON-NLS-1$</span>
<span class="fc" id="L61">        addOption(base, OptionsConstants.BASE_EXCLUSIVE_DB_DEPLOYMENT, true); //$NON-NLS-1$</span>
<span class="fc" id="L62">        addOption(base, OptionsConstants.BASE_DEEP_DEPLOYMENT, false); //$NON-NLS-1$</span>
<span class="fc" id="L63">        addOption(base, OptionsConstants.BASE_BLIND_DROP, false); //$NON-NLS-1$</span>
<span class="fc" id="L64">        addOption(base, OptionsConstants.BASE_REAL_BLIND_DROP, false); //$NON-NLS-1$</span>
<span class="fc" id="L65">        addOption(base, OptionsConstants.BASE_LOBBY_AMMO_DUMP, false); //$NON-NLS-1$</span>
<span class="fc" id="L66">        addOption(base, OptionsConstants.BASE_DUMPING_FROM_ROUND, 1); //$NON-NLS-1$</span>
<span class="fc" id="L67">        addOption(base, OptionsConstants.BASE_SET_ARTY_PLAYER_HOMEEDGE, false); //$NON-NLS-1$</span>
<span class="fc" id="L68">        addOption(base, OptionsConstants.BASE_RESTRICT_GAME_COMMANDS, false); //$NON-NLS-1$</span>
<span class="fc" id="L69">        addOption(base, OptionsConstants.BASE_DISABLE_LOCAL_SAVE, false); //$NON-NLS-1$</span>
<span class="fc" id="L70">        addOption(base, OptionsConstants.BASE_BRIDGECF, 0); //$NON-NLS-1$</span>
<span class="fc" id="L71">        addOption(base, OptionsConstants.BASE_SHOW_BAY_DETAIL, false); //$NON-NLS-1$</span>
<span class="fc" id="L72">        addOption(base, OptionsConstants.BASE_RNG_TYPE, 1); //$NON-NLS-1$</span>
<span class="fc" id="L73">        addOption(base, OptionsConstants.BASE_RNG_LOG, false); //$NON-NLS-1$</span>
<span class="fc" id="L74">        addOption(base, OptionsConstants.BASE_FLAMER_HEAT, false); //$NON-NLS-1$</span>
<span class="fc" id="L75">        addOption(base, OptionsConstants.BASE_INDIRECT_FIRE, true); //$NON-NLS-1$</span>
<span class="fc" id="L76">        addOption(base, OptionsConstants.BASE_BREEZE, false); //$NON-NLS-1$</span>
<span class="fc" id="L77">        addOption(base, OptionsConstants.BASE_RANDOM_BASEMENTS, true); //$NON-NLS-1$</span>
<span class="fc" id="L78">        addOption(base, OptionsConstants.BASE_AUTO_AMS, true); //$NON-NLS-1$</span>
<span class="fc" id="L79">        addOption(base, OptionsConstants.BASE_TURN_TIMER, 0); //$NON-NLS-1$</span>

<span class="fc" id="L81">        IBasicOptionGroup victory = addGroup(&quot;victory&quot;); //$NON-NLS-1$</span>
<span class="fc" id="L82">        addOption(victory, OptionsConstants.VICTORY_SKIP_FORCED_VICTORY, false); //$NON-NLS-1$</span>
<span class="fc" id="L83">        addOption(victory, OptionsConstants.VICTORY_CHECK_VICTORY, true); //$NON-NLS-1$</span>
<span class="fc" id="L84">        addOption(victory, OptionsConstants.VICTORY_ACHIEVE_CONDITIONS, 1); //$NON-NLS-1$</span>
<span class="fc" id="L85">        addOption(victory, OptionsConstants.VICTORY_USE_BV_DESTROYED, false); //$NON-NLS-1$</span>
<span class="fc" id="L86">        addOption(victory, OptionsConstants.VICTORY_BV_DESTROYED_PERCENT, 100); //$NON-NLS-1$</span>
<span class="fc" id="L87">        addOption(victory, OptionsConstants.VICTORY_USE_BV_RATIO, false); //$NON-NLS-1$</span>
<span class="fc" id="L88">        addOption(victory, OptionsConstants.VICTORY_BV_RATIO_PERCENT, 300); //$NON-NLS-1$</span>
<span class="fc" id="L89">        addOption(victory, OptionsConstants.VICTORY_USE_GAME_TURN_LIMIT, false); //$NON-NLS-1$</span>
<span class="fc" id="L90">        addOption(victory, OptionsConstants.VICTORY_GAME_TURN_LIMIT, 10); //$NON-NLS-1$</span>
<span class="fc" id="L91">        addOption(victory, OptionsConstants.VICTORY_USE_KILL_COUNT, false); //$NON-NLS-1$</span>
<span class="fc" id="L92">        addOption(victory, OptionsConstants.VICTORY_GAME_KILL_COUNT, 4); //$NON-NLS-1$</span>
<span class="fc" id="L93">        addOption(victory, OptionsConstants.VICTORY_COMMANDER_KILLED, false); //$NON-NLS-1$</span>

<span class="fc" id="L95">        IBasicOptionGroup allowed = addGroup(&quot;allowedUnits&quot;); //$NON-NLS-1$</span>
<span class="fc" id="L96">        addOption(allowed, OptionsConstants.ALLOWED_CANON_ONLY, false); //$NON-NLS-1$</span>
<span class="fc" id="L97">        addOption(allowed, OptionsConstants.ALLOWED_YEAR, 3150); //$NON-NLS-1$</span>
<span class="fc" id="L98">        addOption(allowed, OptionsConstants.ALLOWED_TECHLEVEL, IOption.CHOICE, TechConstants.T_SIMPLE_NAMES[TechConstants.T_SIMPLE_STANDARD]); //$NON-NLS-1$</span>
<span class="fc" id="L99">        addOption(allowed, OptionsConstants.ALLOWED_ERA_BASED, false);</span>
<span class="fc" id="L100">        addOption(allowed, OptionsConstants.ALLOWED_ALLOW_ILLEGAL_UNITS, false); //$NON-NLS-1$</span>
<span class="fc" id="L101">        addOption(allowed, OptionsConstants.ALLOWED_CLAN_IGNORE_EQ_LIMITS, false); //$NON-NLS-1$</span>
<span class="fc" id="L102">        addOption(allowed, OptionsConstants.ALLOWED_NO_CLAN_PHYSICAL, false); //$NON-NLS-1$</span>
<span class="fc" id="L103">        addOption(allowed, OptionsConstants.ALLOWED_ALLOW_NUKES, false); //$NON-NLS-1$</span>
<span class="fc" id="L104">        addOption(allowed, OptionsConstants.ALLOWED_REALLY_ALLOW_NUKES, false); //$NON-NLS-1$</span>
           
<span class="fc" id="L106">        IBasicOptionGroup advancedRules = addGroup(&quot;advancedRules&quot;); //$NON-NLS-1$</span>
<span class="fc" id="L107">        addOption(advancedRules, OptionsConstants.ADVANCED_MINEFIELDS, false); //$NON-NLS-1$</span>
<span class="fc" id="L108">        addOption(advancedRules, OptionsConstants.ADVANCED_HIDDEN_UNITS, false); //$NON-NLS-1$</span>
<span class="fc" id="L109">        addOption(advancedRules, OptionsConstants.ADVANCED_DOUBLE_BLIND, false); //$NON-NLS-1$</span>
<span class="fc" id="L110">        addOption(advancedRules, OptionsConstants.ADVANCED_TACOPS_SENSORS, false); //$NON-NLS-1$</span>
<span class="fc" id="L111">        addOption(advancedRules, OptionsConstants.ADVANCED_SUPRESS_ALL_DB_MESSAGES, false); //$NON-NLS-1$</span>
<span class="fc" id="L112">        addOption(advancedRules, OptionsConstants.ADVANCED_SUPPRESS_DB_BV, false); //$NON-NLS-1$</span>
<span class="fc" id="L113">        addOption(advancedRules, OptionsConstants.ADVANCED_TEAM_VISION, true); //$NON-NLS-1$</span>
<span class="fc" id="L114">        addOption(advancedRules, OptionsConstants.ADVANCED_TACOPS_BAP, false); //$NON-NLS-1$</span>
<span class="fc" id="L115">        addOption(advancedRules, OptionsConstants.ADVANCED_TACOPS_ECCM, false); //$NON-NLS-1$</span>
<span class="fc" id="L116">        addOption(advancedRules, OptionsConstants.ADVANCED_TACOPS_GHOST_TARGET, false); //$NON-NLS-1$</span>
<span class="fc" id="L117">        addOption(advancedRules, OptionsConstants.ADVANCED_GHOST_TARGET_MAX, 5); //$NON-NLS-1$</span>
<span class="fc" id="L118">        addOption(advancedRules, OptionsConstants.ADVANCED_TACOPS_DIG_IN, false); //$NON-NLS-1$</span>
<span class="fc" id="L119">        addOption(advancedRules, OptionsConstants.ADVANCED_TACOPS_BA_WEIGHT, false); //$NON-NLS-1$</span>
<span class="fc" id="L120">        addOption(advancedRules, OptionsConstants.ADVANCED_TACOPS_TAKE_COVER, false); //$NON-NLS-1$</span>
<span class="fc" id="L121">        addOption(advancedRules, OptionsConstants.ADVANCED_TACOPS_ANGEL_ECM, false); //$NON-NLS-1$</span>
<span class="fc" id="L122">        addOption(advancedRules, OptionsConstants.ADVANCED_TACOPS_BATTLE_WRECK, false); //$NON-NLS-1$</span>
<span class="fc" id="L123">        addOption(advancedRules, OptionsConstants.ADVANCED_TACOPS_SKIN_OF_THE_TEETH_EJECTION, false); //$NON-NLS-1$</span>
<span class="fc" id="L124">        addOption(advancedRules, OptionsConstants.ADVANCED_TACOPS_MOBILE_HQS, false); //$NON-NLS-1$</span>
<span class="fc" id="L125">        addOption(advancedRules, OptionsConstants.ADVANCED_TACOPS_FATIGUE, false); //$NON-NLS-1$</span>
<span class="fc" id="L126">        addOption(advancedRules, OptionsConstants.ADVANCED_TACOPS_FUMBLES, false); //$NON-NLS-1$</span>
<span class="fc" id="L127">        addOption(advancedRules, OptionsConstants.ADVANCED_TACOPS_SELF_DESTRUCT, false); //$NON-NLS-1$</span>
<span class="fc" id="L128">        addOption(advancedRules, OptionsConstants.ADVANCED_TACOPS_TANK_CREWS, false); //$NON-NLS-1$</span>
<span class="fc" id="L129">        addOption(advancedRules, OptionsConstants.ADVANCED_STRATOPS_QUIRKS, false); //$NON-NLS-1$</span>
<span class="fc" id="L130">        addOption(advancedRules, OptionsConstants.ADVANCED_STRATOPS_PARTIALREPAIRS, false); //$NON-NLS-1$</span>
<span class="fc" id="L131">        addOption(advancedRules, OptionsConstants.ADVANCED_ASSAULT_DROP, false); //$NON-NLS-1$</span>
<span class="fc" id="L132">        addOption(advancedRules, OptionsConstants.ADVANCED_PARATROOPERS, false); //$NON-NLS-1$</span>
<span class="fc" id="L133">        addOption(advancedRules, OptionsConstants.ADVANCED_INCLUSIVE_SENSOR_RANGE, false); //$NON-NLS-1$</span>
<span class="fc" id="L134">        addOption(advancedRules, OptionsConstants.ADVANCED_SENSORS_DETECT_ALL, false); //$NON-NLS-1$</span>
<span class="fc" id="L135">        addOption(advancedRules, OptionsConstants.ADVANCED_MAGSCAN_NOHILLS, false); //$NON-NLS-1$</span>
<span class="fc" id="L136">        addOption(advancedRules, OptionsConstants.ADVANCED_WOODS_BURN_DOWN, false); //$NON-NLS-1$</span>
<span class="fc" id="L137">        addOption(advancedRules, OptionsConstants.ADVANCED_WOODS_BURN_DOWN_AMOUNT, 5); //$NON-NLS-1$</span>
<span class="fc" id="L138">        addOption(advancedRules, OptionsConstants.ADVANCED_NO_IGNITE_CLEAR, false); //$NON-NLS-1$</span>
<span class="fc" id="L139">        addOption(advancedRules, OptionsConstants.ADVANCED_ALL_HAVE_EI_COCKPIT, false); //$NON-NLS-1$</span>
<span class="fc" id="L140">        addOption(advancedRules, OptionsConstants.ADVANCED_EXTREME_TEMPERATURE_SURVIVAL, false); //$NON-NLS-1$</span>
<span class="fc" id="L141">        addOption(advancedRules, OptionsConstants.ADVANCED_ARMED_MECHWARRIORS, false); //$NON-NLS-1$</span>
<span class="fc" id="L142">        addOption(advancedRules, OptionsConstants.ADVANCED_PILOTS_VISUAL_RANGE_ONE, false); //$NON-NLS-1$</span>
<span class="fc" id="L143">        addOption(advancedRules, OptionsConstants.ADVANCED_PILOTS_CANNOT_SPOT, false); //$NON-NLS-1$</span>
<span class="fc" id="L144">        addOption(advancedRules, OptionsConstants.ADVANCED_METAL_CONTENT, false); //$NON-NLS-1$</span>
<span class="fc" id="L145">        addOption(advancedRules, OptionsConstants.ADVANCED_BA_GRAB_BARS, false); //$NON-NLS-1$</span>
<span class="fc" id="L146">        addOption(advancedRules, OptionsConstants.ADVANCED_MAXTECH_MOVEMENT_MODS, false); //$NON-NLS-1$</span>
<span class="fc" id="L147">        addOption(advancedRules, OptionsConstants.ADVANCED_ALTERNATE_MASC, false); //$NON-NLS-1$</span>
<span class="fc" id="L148">        addOption(advancedRules, OptionsConstants.ADVANCED_ALTERNATE_MASC_ENHANCED, false); //$NON-NLS-1$</span>
<span class="fc" id="L149">        addOption(advancedRules, OptionsConstants.ADVANCED_GEOMETRIC_MEAN_BV, false); //$NON-NLS-1$\</span>
<span class="fc" id="L150">        addOption(advancedRules, OptionsConstants.ADVANCED_REDUCED_OVERHEAT_MODIFIER_BV, false); //$NON-NLS-1$</span>
<span class="fc" id="L151">        addOption(advancedRules, OptionsConstants.ADVANCED_ALTERNATE_PILOT_BV_MOD, false); //$NON-NLS-1$</span>
        

<span class="fc" id="L154">        IBasicOptionGroup advancedCombat = addGroup(&quot;advancedCombat&quot;); //$NON-NLS-1$</span>
<span class="fc" id="L155">        addOption(advancedCombat, OptionsConstants.ADVCOMBAT_TACOPS_AMS, false); // $NON-NLS-1$</span>
<span class="fc" id="L156">        addOption(advancedCombat, OptionsConstants.ADVCOMBAT_TACOPS_MANUAL_AMS, false); // $NON-NLS-1$</span>
<span class="fc" id="L157">        addOption(advancedCombat, OptionsConstants.ADVCOMBAT_FLOATING_CRITS, false); // $NON-NLS-1$</span>
<span class="fc" id="L158">        addOption(advancedCombat, OptionsConstants.ADVCOMBAT_TACOPS_CRIT_ROLL, false); // $NON-NLS-1$</span>
<span class="fc" id="L159">        addOption(advancedCombat, OptionsConstants.ADVCOMBAT_TACOPS_ENGINE_EXPLOSIONS, false); // $NON-NLS-1$</span>
<span class="fc" id="L160">        addOption(advancedCombat, OptionsConstants.ADVCOMBAT_TACOPS_CALLED_SHOTS, false); // $NON-NLS-1$</span>
<span class="fc" id="L161">        addOption(advancedCombat, OptionsConstants.ADVCOMBAT_TACOPS_PRONE_FIRE, false); // $NON-NLS-1$</span>
<span class="fc" id="L162">        addOption(advancedCombat, OptionsConstants.ADVCOMBAT_TACOPS_START_FIRE, false); // $NON-NLS-1$</span>
<span class="fc" id="L163">        addOption(advancedCombat, OptionsConstants.ADVCOMBAT_TACOPS_RANGE, false);</span>
<span class="fc" id="L164">        addOption(advancedCombat, OptionsConstants.ADVCOMBAT_TACOPS_LOS_RANGE, false);</span>
<span class="fc" id="L165">        addOption(advancedCombat, OptionsConstants.ADVCOMBAT_TACOPS_DEAD_ZONES, false); // $NON-NLS-1$</span>
<span class="fc" id="L166">        addOption(advancedCombat, OptionsConstants.ADVCOMBAT_TACOPS_LOS1, false); // $NON-NLS-1$</span>
<span class="fc" id="L167">        addOption(advancedCombat, OptionsConstants.ADVCOMBAT_TACOPS_ALTDMG, false); // $NON-NLS-1$</span>
<span class="fc" id="L168">        addOption(advancedCombat, OptionsConstants.ADVCOMBAT_TACOPS_CLUSTERHITPEN, false); // $NON-NLS-1$</span>
<span class="fc" id="L169">        addOption(advancedCombat, OptionsConstants.ADVCOMBAT_TACOPS_PPC_INHIBITORS, false); // $NON-NLS-1$</span>
<span class="fc" id="L170">        addOption(advancedCombat, OptionsConstants.ADVCOMBAT_TACOPS_CHARGE_DAMAGE, false); // $NON-NLS-1$</span>
<span class="fc" id="L171">        addOption(advancedCombat, OptionsConstants.ADVCOMBAT_TACOPS_GLANCING_BLOWS, false); // $NON-NLS-1$</span>
<span class="fc" id="L172">        addOption(advancedCombat, OptionsConstants.ADVCOMBAT_TACOPS_DIRECT_BLOW, false); // $NON-NLS-1$</span>
<span class="fc" id="L173">        addOption(advancedCombat, OptionsConstants.ADVCOMBAT_TACOPS_BURST, false); // $NON-NLS-1$</span>
<span class="fc" id="L174">        addOption(advancedCombat, OptionsConstants.ADVCOMBAT_TACOPS_HEAT, false); // $NON-NLS-1$</span>
<span class="fc" id="L175">        addOption(advancedCombat, OptionsConstants.ADVCOMBAT_TACOPS_PARTIAL_COVER, false); // $NON-NLS-1$</span>
<span class="fc" id="L176">        addOption(advancedCombat, OptionsConstants.ADVCOMBAT_TACOPS_BA_CRITICALS, false); // $NON-NLS-1$</span>
<span class="fc" id="L177">        addOption(advancedCombat, OptionsConstants.ADVCOMBAT_TACOPS_HOTLOAD, false); // $NON-NLS-1$</span>
<span class="fc" id="L178">        addOption(advancedCombat, OptionsConstants.ADVCOMBAT_TACOPS_RAPID_AC, false); // $NON-NLS-1$</span>
<span class="fc" id="L179">        addOption(advancedCombat, OptionsConstants.ADVCOMBAT_KIND_RAPID_AC, false); // $NON-NLS-1$</span>
<span class="fc" id="L180">        addOption(advancedCombat, OptionsConstants.ADVCOMBAT_TACOPS_GRAPPLING, false); // $NON-NLS-1$</span>
<span class="fc" id="L181">        addOption(advancedCombat, OptionsConstants.ADVCOMBAT_TACOPS_JUMP_JET_ATTACK, false); // $NON-NLS-1$</span>
<span class="fc" id="L182">        addOption(advancedCombat, OptionsConstants.ADVCOMBAT_TACOPS_TRIP_ATTACK, false); // $NON-NLS-1$</span>
<span class="fc" id="L183">        addOption(advancedCombat, OptionsConstants.ADVCOMBAT_TACOPS_ENERGY_WEAPONS, false); // $NON-NLS-1$</span>
<span class="fc" id="L184">        addOption(advancedCombat, OptionsConstants.ADVCOMBAT_TACOPS_GAUSS_WEAPONS, false); // $NON-NLS-1$</span>
<span class="fc" id="L185">        addOption(advancedCombat, OptionsConstants.ADVCOMBAT_TACOPS_RETRACTABLE_BLADES, false); // $NON-NLS-1$</span>
<span class="fc" id="L186">        addOption(advancedCombat, OptionsConstants.ADVCOMBAT_TACOPS_AMMUNITION, false); // $NON-NLS-1$</span>
<span class="fc" id="L187">        addOption(advancedCombat, OptionsConstants.ADVCOMBAT_TACOPS_WOODS_COVER, false); // $NON-NLS-1$</span>
<span class="fc" id="L188">        addOption(advancedCombat, OptionsConstants.ADVCOMBAT_TACOPS_VEHICLE_EFFECTIVE, false); // $NON-NLS-1$</span>
<span class="fc" id="L189">        addOption(advancedCombat, OptionsConstants.ADVCOMBAT_TACOPS_VEHICLE_ARCS, false); // $NON-NLS-1$</span>
<span class="fc" id="L190">        addOption(advancedCombat, OptionsConstants.ADVCOMBAT_TACOPS_VTOL_ATTACKS, false); // $NON-NLS-1$</span>
<span class="fc" id="L191">        addOption(advancedCombat, OptionsConstants.ADVCOMBAT_TACOPS_ADVANCED_MECH_HIT_LOCATIONS, false); // $NON-NLS-1$</span>
<span class="fc" id="L192">        addOption(advancedCombat, OptionsConstants.ADVCOMBAT_TACOPS_COOLANT_FAILURE, false); // $NON-NLS-1$</span>
<span class="fc" id="L193">        addOption(advancedCombat, OptionsConstants.ADVCOMBAT_TACOPS_BA_VS_BA, false); // $NON-NLS-1$</span>
<span class="fc" id="L194">        addOption(advancedCombat, OptionsConstants.ADVCOMBAT_NO_TAC, false); // $NON-NLS-1$</span>
<span class="fc" id="L195">        addOption(advancedCombat, OptionsConstants.ADVCOMBAT_VEHICLES_THRESHOLD, false); // $NON-NLS-1$</span>
<span class="fc" id="L196">        addOption(advancedCombat, OptionsConstants.ADVCOMBAT_VEHICLES_THRESHOLD_VARIABLE, false); // $NON-NLS-1$</span>
<span class="fc" id="L197">        addOption(advancedCombat, OptionsConstants.ADVCOMBAT_VEHICLES_THRESHOLD_DIVISOR, 10); // $NON-NLS-1$</span>
<span class="fc" id="L198">        addOption(advancedCombat, OptionsConstants.ADVCOMBAT_VTOL_STRAFING, false); // $NON-NLS-1$</span>
<span class="fc" id="L199">        addOption(advancedCombat, OptionsConstants.ADVCOMBAT_VEHICLES_SAFE_FROM_INFERNOS, false); // $NON-NLS-1$</span>
<span class="fc" id="L200">        addOption(advancedCombat, OptionsConstants.ADVCOMBAT_PROTOS_SAFE_FROM_INFERNOS, false); // $NON-NLS-1$</span>
<span class="fc" id="L201">        addOption(advancedCombat, OptionsConstants.ADVCOMBAT_INDIRECT_ALWAYS_POSSIBLE, false); // $NON-NLS-1$</span>
<span class="fc" id="L202">        addOption(advancedCombat, OptionsConstants.ADVCOMBAT_INCREASED_AC_DMG, false); // $NON-NLS-1$</span>
<span class="fc" id="L203">        addOption(advancedCombat, OptionsConstants.ADVCOMBAT_INCREASED_ISERLL_RANGE, false); // $NON-NLS-1$</span>
<span class="fc" id="L204">        addOption(advancedCombat, OptionsConstants.ADVCOMBAT_UNJAM_UAC, false); // $NON-NLS-1$</span>
<span class="fc" id="L205">        addOption(advancedCombat, OptionsConstants.ADVCOMBAT_UAC_TWOROLLS, false); // $NON-NLS-1$</span>
<span class="fc" id="L206">        addOption(advancedCombat, OptionsConstants.ADVCOMBAT_CLUBS_PUNCH, false); // $NON-NLS-1$</span>
<span class="fc" id="L207">        addOption(advancedCombat, OptionsConstants.ADVCOMBAT_ON_MAP_PREDESIGNATE, false); // $NON-NLS-1$</span>
<span class="fc" id="L208">        addOption(advancedCombat, OptionsConstants.ADVCOMBAT_NUM_HEXES_PREDESIGNATE, 5); // $NON-NLS-1$</span>
<span class="fc" id="L209">        addOption(advancedCombat, OptionsConstants.ADVCOMBAT_MAP_AREA_PREDESIGNATE, 1088); // $NON-NLS-1$</span>
<span class="fc" id="L210">        addOption(advancedCombat, OptionsConstants.ADVCOMBAT_MAX_EXTERNAL_HEAT, 15); // $NON-NLS-1$</span>
<span class="fc" id="L211">        addOption(advancedCombat, OptionsConstants.ADVCOMBAT_CASE_PILOT_DAMAGE, false); // $NON-NLS-1$</span>
<span class="fc" id="L212">        addOption(advancedCombat, OptionsConstants.ADVCOMBAT_NO_FORCED_PRIMARY_TARGETS, false); // $NON-NLS-1$</span>
<span class="fc" id="L213">        addOption(advancedCombat, OptionsConstants.ADVCOMBAT_FULL_ROTOR_HITS, false); // $NON-NLS-1$</span>
<span class="fc" id="L214">        addOption(advancedCombat, OptionsConstants.ADVCOMBAT_FOREST_FIRES_NO_SMOKE, false); // $NON-NLS-1$</span>
<span class="fc" id="L215">        addOption(advancedCombat, OptionsConstants.ADVCOMBAT_HOTLOAD_IN_GAME, false); // $NON-NLS-1$</span>
<span class="fc" id="L216">        addOption(advancedCombat, OptionsConstants.ADVCOMBAT_MULTI_USE_AMS, false); // $NON-NLS-1$</span>
    
<span class="fc" id="L218">        IBasicOptionGroup advancedGroundMovement = addGroup(&quot;advancedGroundMovement&quot;); //$NON-NLS-1$</span>
<span class="fc" id="L219">        addOption(advancedGroundMovement, OptionsConstants.ADVGRNDMOV_TACOPS_SPRINT, false); //$NON-NLS-1$</span>
<span class="fc" id="L220">        addOption(advancedGroundMovement, OptionsConstants.ADVGRNDMOV_TACOPS_STANDING_STILL, false); //$NON-NLS-1$</span>
<span class="fc" id="L221">        addOption(advancedGroundMovement, OptionsConstants.ADVGRNDMOV_TACOPS_EVADE, false); //$NON-NLS-1$</span>
<span class="fc" id="L222">        addOption(advancedGroundMovement, OptionsConstants.ADVGRNDMOV_TACOPS_SKILLED_EVASION, false); //$NON-NLS-1$</span>
<span class="fc" id="L223">        addOption(advancedGroundMovement, OptionsConstants.ADVGRNDMOV_TACOPS_LEAPING, false); //$NON-NLS-1$</span>
<span class="fc" id="L224">        addOption(advancedGroundMovement, OptionsConstants.ADVGRNDMOV_TACOPS_PHYSICAL_PSR, false); //$NON-NLS-1$</span>
<span class="fc" id="L225">        addOption(advancedGroundMovement, OptionsConstants.ADVGRNDMOV_TACOPS_PHYSICAL_ATTACK_PSR, false); //$NON-NLS-1$</span>
<span class="fc" id="L226">        addOption(advancedGroundMovement, OptionsConstants.ADVGRNDMOV_TACOPS_TAKING_DAMAGE, false); //$NON-NLS-1$</span>
<span class="fc" id="L227">        addOption(advancedGroundMovement, OptionsConstants.ADVGRNDMOV_TACOPS_LEG_DAMAGE, false); //$NON-NLS-1$</span>
<span class="fc" id="L228">        addOption(advancedGroundMovement, OptionsConstants.ADVGRNDMOV_TACOPS_WALK_BACKWARDS, false); //$NON-NLS-1$</span>
<span class="fc" id="L229">        addOption(advancedGroundMovement, OptionsConstants.ADVGRNDMOV_TACOPS_FAST_INFANTRY_MOVE, false); //$NON-NLS-1$</span>
<span class="fc" id="L230">        addOption(advancedGroundMovement, OptionsConstants.ADVGRNDMOV_VEHICLE_LANCE_MOVEMENT, false); //$NON-NLS-1$</span>
<span class="fc" id="L231">        addOption(advancedGroundMovement, OptionsConstants.ADVGRNDMOV_VEHICLE_LANCE_MOVEMENT_NUMBER, 4); //$NON-NLS-1$</span>
<span class="fc" id="L232">        addOption(advancedGroundMovement, OptionsConstants.ADVGRNDMOV_VEHICLE_ACCELERATION, false); //$NON-NLS-1$</span>
<span class="fc" id="L233">        addOption(advancedGroundMovement, OptionsConstants.ADVGRNDMOV_REVERSE_GEAR, false); //$NON-NLS-1$</span>
<span class="fc" id="L234">        addOption(advancedGroundMovement, OptionsConstants.ADVGRNDMOV_TURN_MODE, false); //$NON-NLS-1$</span>
<span class="fc" id="L235">        addOption(advancedGroundMovement, OptionsConstants.ADVGRNDMOV_VEHICLE_ADVANCED_MANEUVERS, false); //$NON-NLS-1$</span>
<span class="fc" id="L236">        addOption(advancedGroundMovement, OptionsConstants.ADVGRNDMOV_TACOPS_HULL_DOWN, false); //$NON-NLS-1$</span>
<span class="fc" id="L237">        addOption(advancedGroundMovement, OptionsConstants.ADVGRNDMOV_TACOPS_FALLING_EXPANDED, false); //$NON-NLS-1$</span>
<span class="fc" id="L238">        addOption(advancedGroundMovement, OptionsConstants.ADVGRNDMOV_TACOPS_ATTEMPTING_STAND, false); //$NON-NLS-1$</span>
<span class="fc" id="L239">        addOption(advancedGroundMovement, OptionsConstants.ADVGRNDMOV_TACOPS_CAREFUL_STAND, false); //$NON-NLS-1$</span>
<span class="fc" id="L240">        addOption(advancedGroundMovement, OptionsConstants.ADVGRNDMOV_TACOPS_ZIPLINES, false); //$NON-NLS-1$</span>
<span class="fc" id="L241">        addOption(advancedGroundMovement, OptionsConstants.ADVGRNDMOV_MEK_LANCE_MOVEMENT, false); //$NON-NLS-1$</span>
<span class="fc" id="L242">        addOption(advancedGroundMovement, OptionsConstants.ADVGRNDMOV_MEK_LANCE_MOVEMENT_NUMBER, 4); //$NON-NLS-1$</span>
<span class="fc" id="L243">        addOption(advancedGroundMovement, OptionsConstants.ADVGRNDMOV_NO_IMMOBILE_VEHICLES, false); //$NON-NLS-1$</span>
<span class="fc" id="L244">        addOption(advancedGroundMovement, OptionsConstants.ADVGRNDMOV_VEHICLES_CAN_EJECT, false);</span>
<span class="fc" id="L245">        addOption(advancedGroundMovement, OptionsConstants.ADVGRNDMOV_EJECTED_PILOTS_FLEE, false);</span>
<span class="fc" id="L246">        addOption(advancedGroundMovement, OptionsConstants.ADVGRNDMOV_AUTO_ABANDON_UNIT, false); //$NON-NLS-1$</span>
<span class="fc" id="L247">        addOption(advancedGroundMovement, OptionsConstants.ADVGRNDMOV_NO_HOVER_CHARGE, false); //$NON-NLS-1$</span>
<span class="fc" id="L248">        addOption(advancedGroundMovement, OptionsConstants.ADVGRNDMOV_NO_PREMOVE_VIBRA, false); //$NON-NLS-1$</span>
<span class="fc" id="L249">        addOption(advancedGroundMovement, OptionsConstants.ADVGRNDMOV_FALLS_END_MOVEMENT, false); //$NON-NLS-1$</span>
<span class="fc" id="L250">        addOption(advancedGroundMovement, OptionsConstants.ADVGRNDMOV_PSR_JUMP_HEAVY_WOODS, false);</span>
<span class="fc" id="L251">        addOption(advancedGroundMovement, OptionsConstants.ADVGRNDMOV_NO_NIGHT_MOVE_PEN, false); //$NON-NLS-1$</span>

<span class="fc" id="L253">        IBasicOptionGroup advAeroRules = addGroup(&quot;advancedAeroRules&quot;); //$NON-NLS-1$</span>
<span class="fc" id="L254">        addOption(advAeroRules, OptionsConstants.ADVAERORULES_AERO_GROUND_MOVE, true); //$NON-NLS-1$</span>
<span class="fc" id="L255">        addOption(advAeroRules, OptionsConstants.ADVAERORULES_STRATOPS_CAPITAL_FIGHTER, false); //$NON-NLS-1$</span>
<span class="fc" id="L256">        addOption(advAeroRules, OptionsConstants.ADVAERORULES_FUEL_CONSUMPTION, false); //$NON-NLS-1$</span>
<span class="fc" id="L257">        addOption(advAeroRules, OptionsConstants.ADVAERORULES_STRATOPS_CONV_FUSION_BONUS, false); //$NON-NLS-1$</span>
<span class="fc" id="L258">        addOption(advAeroRules, OptionsConstants.ADVAERORULES_STRATOPS_HARJEL, false); //$NON-NLS-1$</span>
<span class="fc" id="L259">        addOption(advAeroRules, OptionsConstants.ADVAERORULES_STRATOPS_GRAV_EFFECTS, false); //$NON-NLS-1$</span>
<span class="fc" id="L260">        addOption(advAeroRules, OptionsConstants.ADVAERORULES_ADVANCED_MOVEMENT, false); //$NON-NLS-1$</span>
<span class="fc" id="L261">        addOption(advAeroRules, OptionsConstants.ADVAERORULES_HEAT_BY_BAY, false); //$NON-NLS-1$</span>
<span class="fc" id="L262">        addOption(advAeroRules, OptionsConstants.ADVAERORULES_ATMOSPHERIC_CONTROL, false); //$NON-NLS-1$</span>
<span class="fc" id="L263">        addOption(advAeroRules, OptionsConstants.ADVAERORULES_AMMO_EXPLOSIONS, false); //$NON-NLS-1$</span>
<span class="fc" id="L264">        addOption(advAeroRules, OptionsConstants.ADVAERORULES_STRATOPS_AA_FIRE, false); //$NON-NLS-1$</span>
<span class="fc" id="L265">        addOption(advAeroRules, OptionsConstants.ADVAERORULES_STRATOPS_AAA_LASER, false); //$NON-NLS-1$</span>
<span class="fc" id="L266">        addOption(advAeroRules, OptionsConstants.ADVAERORULES_STRATOPS_ADV_POINTDEF, false); //$NON-NLS-1$</span>
<span class="fc" id="L267">        addOption(advAeroRules, OptionsConstants.ADVAERORULES_STRATOPS_BRACKET_FIRE, false); //$NON-NLS-1$</span>
<span class="fc" id="L268">        addOption(advAeroRules, OptionsConstants.ADVAERORULES_STRATOPS_ECM, false); //$NON-NLS-1$</span>
<span class="fc" id="L269">        addOption(advAeroRules, OptionsConstants.ADVAERORULES_STRATOPS_SENSOR_SHADOW, false); //$NON-NLS-1$</span>
<span class="fc" id="L270">        addOption(advAeroRules, OptionsConstants.ADVAERORULES_STRATOPS_OVER_PENETRATE, false); //$NON-NLS-1$</span>
<span class="fc" id="L271">        addOption(advAeroRules, OptionsConstants.ADVAERORULES_STRATOPS_SPACE_BOMB, false); //$NON-NLS-1$</span>
<span class="fc" id="L272">        addOption(advAeroRules, OptionsConstants.ADVAERORULES_STRATOPS_BEARINGS_ONLY_LAUNCH, false); //$NON-NLS-1$</span>
<span class="fc" id="L273">        addOption(advAeroRules, OptionsConstants.ADVAERORULES_STRATOPS_BEARINGS_ONLY_VELOCITY, 50); //$NON-NLS-1$</span>
<span class="fc" id="L274">        addOption(advAeroRules, OptionsConstants.ADVAERORULES_STRATOPS_WAYPOINT_LAUNCH, false); //$NON-NLS-1$</span>
<span class="fc" id="L275">        addOption(advAeroRules, OptionsConstants.ADVAERORULES_STRATOPS_ADVANCED_SENSORS, false); //$NON-NLS-1$</span>
<span class="fc" id="L276">        addOption(advAeroRules, OptionsConstants.ADVAERORULES_VARIABLE_DAMAGE_THRESH, false); //$NON-NLS-1$</span>
<span class="fc" id="L277">        addOption(advAeroRules, OptionsConstants.ADVAERORULES_AT2_NUKES, false); //$NON-NLS-1$</span>
<span class="fc" id="L278">        addOption(advAeroRules, OptionsConstants.ADVAERORULES_AERO_SANITY, false); //$NON-NLS-1$</span>
<span class="fc" id="L279">        addOption(advAeroRules, OptionsConstants.ADVAERORULES_RETURN_FLYOVER, true); //$NON-NLS-1$</span>
<span class="fc" id="L280">        addOption(advAeroRules, OptionsConstants.ADVAERORULES_AA_MOVE_MOD, false); //$NON-NLS-1$</span>
<span class="fc" id="L281">        addOption(advAeroRules, OptionsConstants.ADVAERORULES_ALLOW_LARGE_SQUADRONS, false); //$NON-NLS-1$</span>
<span class="fc" id="L282">        addOption(advAeroRules, OptionsConstants.ADVAERORULES_SINGLE_NO_CAP, false); //$NON-NLS-1$</span>
<span class="fc" id="L283">        addOption(advAeroRules, OptionsConstants.ADVAERORULES_AERO_ARTILLERY_MUNITIONS, false); //$NON-NLS-1$</span>
<span class="fc" id="L284">        addOption(advAeroRules, OptionsConstants.ADVAERORULES_EXPANDED_KF_DRIVE_DAMAGE, false); //$NON-NLS-1$</span>

<span class="fc" id="L286">        IBasicOptionGroup initiative = addGroup(&quot;initiative&quot;); //$NON-NLS-1$</span>
<span class="fc" id="L287">        addOption(initiative, OptionsConstants.INIT_INF_MOVE_EVEN, false); //$NON-NLS-1$</span>
<span class="fc" id="L288">        addOption(initiative, OptionsConstants.INIT_INF_DEPLOY_EVEN, false); //$NON-NLS-1$</span>
<span class="fc" id="L289">        addOption(initiative, OptionsConstants.INIT_INF_MOVE_LATER, false); //$NON-NLS-1$</span>
<span class="fc" id="L290">        addOption(initiative, OptionsConstants.INIT_INF_MOVE_MULTI, false); //$NON-NLS-1$</span>
<span class="fc" id="L291">        addOption(initiative, OptionsConstants.INIT_PROTOS_MOVE_EVEN, false); //$NON-NLS-1$</span>
<span class="fc" id="L292">        addOption(initiative, OptionsConstants.INIT_PROTOS_MOVE_EVEN, false); //$NON-NLS-1$</span>
<span class="fc" id="L293">        addOption(initiative, OptionsConstants.INIT_PROTOS_MOVE_LATER, false); //$NON-NLS-1$</span>
<span class="fc" id="L294">        addOption(initiative, OptionsConstants.INIT_PROTOS_MOVE_MULTI, false); //$NON-NLS-1$</span>
<span class="fc" id="L295">        addOption(initiative, OptionsConstants.INIT_INF_PROTO_MOVE_MULTI, 3); //$NON-NLS-1$</span>
<span class="fc" id="L296">        addOption(initiative, OptionsConstants.INIT_SIMULTANEOUS_DEPLOYMENT, false); //$NON-NLS-1$</span>
<span class="fc" id="L297">        addOption(initiative, OptionsConstants.INIT_SIMULTANEOUS_MOVEMENT, false); //$NON-NLS-1$</span>
<span class="fc" id="L298">        addOption(initiative, OptionsConstants.INIT_SIMULTANEOUS_TARGETING, false); //$NON-NLS-1$</span>
<span class="fc" id="L299">        addOption(initiative, OptionsConstants.INIT_SIMULTANEOUS_FIRING, false); //$NON-NLS-1$</span>
<span class="fc" id="L300">        addOption(initiative, OptionsConstants.INIT_SIMULTANEOUS_PHYSICAL, false); //$NON-NLS-1$</span>
<span class="fc" id="L301">        addOption(initiative, OptionsConstants.INIT_FRONT_LOAD_INITIATIVE, false); //$NON-NLS-1$</span>
<span class="fc" id="L302">        addOption(initiative, OptionsConstants.INIT_INITIATIVE_STREAK_COMPENSATION, false); //$NON-NLS-1$</span>
        
<span class="fc" id="L304">        IBasicOptionGroup rpg = addGroup(&quot;rpg&quot;); //$NON-NLS-1</span>
<span class="fc" id="L305">        addOption(rpg, OptionsConstants.RPG_PILOT_ADVANTAGES, false); //$NON-NLS-1$</span>
<span class="fc" id="L306">        addOption(rpg, OptionsConstants.EDGE, false); //$NON-NLS-1$</span>
<span class="fc" id="L307">        addOption(rpg, OptionsConstants.RPG_MANEI_DOMINI, false); //$NON-NLS-1$</span>
<span class="fc" id="L308">        addOption(rpg, OptionsConstants.RPG_INDIVIDUAL_INITIATIVE, false); //$NON-NLS-1$</span>
<span class="fc" id="L309">        addOption(rpg, OptionsConstants.RPG_COMMAND_INIT, false); //$NON-NLS-1$</span>
<span class="fc" id="L310">        addOption(rpg, OptionsConstants.RPG_RPG_GUNNERY, false); //$NON-NLS-1$</span>
<span class="fc" id="L311">        addOption(rpg, OptionsConstants.RPG_ARTILLERY_SKILL, false); //$NON-NLS-1$</span>
<span class="fc" id="L312">        addOption(rpg, OptionsConstants.RPG_TOUGHNESS, false); //$NON-NLS-1$</span>
<span class="fc" id="L313">        addOption(rpg, OptionsConstants.RPG_CONDITIONAL_EJECTION, false); //$NON-NLS-1$</span>
<span class="fc" id="L314">        addOption(rpg, OptionsConstants.RPG_MANUAL_SHUTDOWN, false); //$NON-NLS-1$</span>
<span class="fc" id="L315">        addOption(rpg, OptionsConstants.RPG_BEGIN_SHUTDOWN, false); //$NON-NLS-1$</span>

        //IBasicOptionGroup advancedBuildings = addGroup(&quot;advancedBuildings&quot;); //$NON-NLS-1$

<span class="fc" id="L319">    }</span>

    public Vector&lt;IOption&gt; loadOptions() {
<span class="nc" id="L322">        return loadOptions(new File(GAME_OPTIONS_FILE_NAME), true);</span>
    }

    public synchronized Vector&lt;IOption&gt; loadOptions(File file, boolean print) {
<span class="fc" id="L326">        Vector&lt;IOption&gt; changedOptions = new Vector&lt;&gt;(1, 1);</span>

<span class="pc bpc" id="L328" title="1 of 2 branches missed.">        if (!file.exists()) {</span>
<span class="nc" id="L329">            return changedOptions;</span>
        }
        
        try {
<span class="fc" id="L333">            JAXBContext jc = JAXBContext.newInstance(GameOptionsXML.class, Option.class, BasicOption.class);</span>
            
<span class="fc" id="L335">            Unmarshaller um = jc.createUnmarshaller();</span>
<span class="fc" id="L336">            InputStream is = new FileInputStream(file);</span>
<span class="fc" id="L337">            GameOptionsXML opts = (GameOptionsXML) um.unmarshal(MegaMekXmlUtil.createSafeXmlSource(is));</span>

<span class="fc bfc" id="L339" title="All 2 branches covered.">            for (IBasicOption bo : opts.getOptions()) {</span>
<span class="fc" id="L340">                changedOptions.add(parseOptionNode(bo, print));</span>
<span class="fc" id="L341">            }</span>
<span class="nc" id="L342">        } catch (Exception e) {</span>
<span class="nc" id="L343">            MegaMek.getLogger().error(&quot;Error loading XML for game options: &quot; + e.getMessage(), e);</span>
<span class="fc" id="L344">        }</span>

<span class="fc" id="L346">        return changedOptions;</span>
    }

    private IOption parseOptionNode(final IBasicOption node, final boolean print) {
<span class="fc" id="L350">        IOption option = null;</span>

<span class="fc" id="L352">        String name = node.getName();</span>
<span class="fc" id="L353">        Object value = node.getValue();</span>
<span class="pc bpc" id="L354" title="2 of 4 branches missed.">        if ((null != name) &amp;&amp; (null != value)) {</span>
<span class="fc" id="L355">            IOption tempOption = getOption(name);</span>

<span class="pc bpc" id="L357" title="1 of 2 branches missed.">            if (null != tempOption) {</span>
<span class="fc" id="L358">                if (!tempOption.getValue().toString()</span>
<span class="pc bpc" id="L359" title="1 of 2 branches missed.">                        .equals(value.toString())) {</span>
                    try {
<span class="nc bnc" id="L361" title="All 5 branches missed.">                        switch (tempOption.getType()) {</span>
                            case IOption.STRING:
                            case IOption.CHOICE:
<span class="nc" id="L364">                                tempOption.setValue((String) value);</span>
<span class="nc" id="L365">                                break;</span>

                            case IOption.BOOLEAN:
<span class="nc" id="L368">                                tempOption.setValue(Boolean.valueOf(value</span>
<span class="nc" id="L369">                                        .toString()));</span>
<span class="nc" id="L370">                                break;</span>

                            case IOption.INTEGER:
<span class="nc" id="L373">                                tempOption.setValue(Integer.valueOf(value</span>
<span class="nc" id="L374">                                        .toString()));</span>
<span class="nc" id="L375">                                break;</span>

                            case IOption.FLOAT:
<span class="nc" id="L378">                                tempOption.setValue(Float.valueOf(value</span>
<span class="nc" id="L379">                                        .toString()));</span>
                                break;
                        }
<span class="nc bnc" id="L382" title="All 2 branches missed.">                        if (print) {</span>
<span class="nc" id="L383">                            System.out.println(&quot;Set option '&quot; + name //$NON-NLS-1$</span>
                                    + &quot;' to '&quot; + value + &quot;'.&quot;); //$NON-NLS-1$ //$NON-NLS-2$
                        }

<span class="nc" id="L387">                        option = tempOption;</span>
<span class="nc" id="L388">                    } catch (IllegalArgumentException iaEx) {</span>
<span class="nc" id="L389">                        System.out.println(&quot;Error trying to load option '&quot;</span>
                                + name + &quot;' with a value of '&quot; + value
                                + &quot;'.&quot;); //$NON-NLS-1$ //$NON-NLS-2$ //$NON-NLS-3$
<span class="nc" id="L392">                    }</span>
                }
            } else {
<span class="nc" id="L395">                MegaMek.getLogger().warning(&quot;Invalid option '&quot; + name + &quot;' when trying to load options file.&quot;);</span>
            }
        }

<span class="fc" id="L399">        return option;</span>
    }

    public static void saveOptions(Vector&lt;IBasicOption&gt; options) {
<span class="nc" id="L403">        saveOptions(options, GAME_OPTIONS_FILE_NAME);</span>
<span class="nc" id="L404">    }</span>

    /**
     * Saves the given &lt;code&gt;Vector&lt;/code&gt; of &lt;code&gt;IBasicOption&lt;/code&gt;
     *
     * @param options &lt;code&gt;Vector&lt;/code&gt; of &lt;code&gt;IBasicOption&lt;/code&gt;
     * @param file
     */
    public static void saveOptions(Vector&lt;IBasicOption&gt; options, String file) {
        try {
<span class="fc" id="L414">            JAXBContext jc = JAXBContext.newInstance(GameOptionsXML.class, Option.class, BasicOption.class);</span>
            
<span class="fc" id="L416">            Marshaller marshaller = jc.createMarshaller();</span>
<span class="fc" id="L417">            marshaller.setProperty(Marshaller.JAXB_FORMATTED_OUTPUT, true);</span>
            
            // The default header has the encoding and standalone properties
<span class="fc" id="L420">            marshaller.setProperty(Marshaller.JAXB_FRAGMENT, true);</span>
            try {
<span class="nc" id="L422">            	marshaller.setProperty(&quot;com.sun.xml.internal.bind.xmlHeaders&quot;, &quot;&lt;?xml version=\&quot;1.0\&quot;?&gt;&quot;);</span>
<span class="fc" id="L423">            } catch (PropertyException ex) {</span>
<span class="fc" id="L424">            	marshaller.setProperty(&quot;com.sun.xml.bind.xmlHeaders&quot;, &quot;&lt;?xml version=\&quot;1.0\&quot;?&gt;&quot;);</span>
<span class="nc" id="L425">            }</span>
            
<span class="fc" id="L427">            JAXBElement&lt;GameOptionsXML&gt; element = new JAXBElement&lt;&gt;(new QName(&quot;options&quot;), GameOptionsXML.class, new GameOptionsXML(options));</span>
            
<span class="fc" id="L429">            marshaller.marshal(element, new File(file));</span>
<span class="nc" id="L430">        } catch (JAXBException ex) {</span>
<span class="nc" id="L431">            System.err.println(&quot;Error writing XML for game options: &quot; + ex.getMessage()); //$NON-NLS-1$</span>
<span class="nc" id="L432">            ex.printStackTrace();</span>
<span class="fc" id="L433">        }</span>
<span class="fc" id="L434">    }</span>

    /*
     * (non-Javadoc)
     *
     * @see megamek.common.options.AbstractOptions#getOptionsInfoImp()
     */
    @Override
    protected AbstractOptionsInfo getOptionsInfoImp() {
<span class="fc" id="L443">        return GameOptionsInfo.getInstance();</span>
    }

    private static class GameOptionsInfo extends AbstractOptionsInfo {

<span class="fc" id="L448">        private static AbstractOptionsInfo instance = new GameOptionsInfo();</span>

        protected GameOptionsInfo() {
<span class="fc" id="L451">            super(&quot;GameOptionsInfo&quot;); //$NON-NLS-1$</span>
<span class="fc" id="L452">        }</span>

        public static AbstractOptionsInfo getInstance() {
<span class="fc" id="L455">            return instance;</span>
        }
    }
    
    /**
     * A helper class for the XML binding.
     */
    @XmlRootElement(name = &quot;options&quot;)
    @XmlAccessorType(XmlAccessType.FIELD)
    private static class GameOptionsXML {

        @XmlElement(name = &quot;gameoption&quot;, type = BasicOption.class)
        private Vector&lt;IBasicOption&gt; options;
        
<span class="fc" id="L469">        GameOptionsXML(final Vector&lt;IBasicOption&gt; options) {</span>
<span class="fc" id="L470">            this.options = options;</span>
<span class="fc" id="L471">        }</span>
        
        /**
         * Required for JAXB.
         */
        @SuppressWarnings(&quot;unused&quot;)
        private GameOptionsXML() {
        }

        public Vector&lt;IBasicOption&gt; getOptions() {
<span class="fc" id="L481">            return options;</span>
        }
    }
}
</pre><div class="footer"><span class="right">Created with <a href="http://www.jacoco.org/jacoco">JaCoCo</a> 0.8.4.201905082037</span></div></body></html>